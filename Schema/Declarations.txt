/* THESE LINES ARE MYSQL CODE
DEFAULT CHARSET = utf8 CHARACTER SET 
COLLATE = utf8_unicode_ci COLLATION (GENERIC)
ENGINE = INNODB; OTHER ENGINES DO NOT SUPPORT FK DECLARATIONS */

CREATE TABLE "USER" (
	"ID" serial PRIMARY KEY,
	"USERNAME" varchar(255) NOT NULL UNIQUE,
	"PASSWORD" varchar(255) NOT NULL,
	"MAIL" varchar(255) NOT NULL UNIQUE,
	"SALT" varchar(255), /*NOT NULL*/ /*POR AHORA NO USAREMOS SALT*/
	"SALDO" int, 
	"PIC" text
);


CREATE TABLE "FOLLOWS" (
	"FOLLOWERID" int NOT NULL REFERENCES "USER"("ID"),
	"FOLLOWEDID" int NOT NULL REFERENCES "USER"("ID"),
	PRIMARY KEY ("FOLLOWERID", "FOLLOWEDID")
);

CREATE TABLE "EVENT" (
	"ID" serial NOT NULL PRIMARY KEY,
	"ORGANIZERID" int NOT NULL REFERENCES "USER"("ID"),
        "TITLE" varchar(255) NOT NULL
);

CREATE TABLE "ATTENDS" (
	"ATTENDEEID" int NOT NULL REFERENCES "USER"("ID"),
	"EVENTID" int NOT NULL REFERENCES "EVENT"("ID"),
	PRIMARY KEY ("ATTENDEEID", "EVENTID")
);

CREATE TABLE "COMMENT" (
	"TEXT" varchar(512), 	/*EN CASO DE QUERER COMENTARIO OBLIGATORIO PONER NOT NULL*/
	"USERID" int NOT NULL REFERENCES "USER"("ID"),
	"EVENTID" int NOT NULL REFERENCES "EVENT"("ID"),
	PRIMARY KEY ("USERID","EVENTID")
);

CREATE TABLE "VALORATION" (
	"POINTS" int NOT NULL, 	/*EN CASO DE QUERER COMENTARIO OBLIGATORIO PONER NOT NULL*/
	"USERID" int NOT NULL REFERENCES "USER"("ID"),
	"EVENTID" int NOT NULL REFERENCES "EVENT"("ID"),
	PRIMARY KEY ("USERID","EVENTID")
);

CREATE TABLE "CATEGORY" (
	"ID" serial NOT NULL PRIMARY KEY,
	"NAME" varchar(128) NOT NULL
);

CREATE TABLE "LIKINGS" (
	"USERID" int NOT NULL REFERENCES "USER"("ID"),
	"CATEGORYID" int NOT NULL REFERENCES "CATEGORY"("ID"),
	PRIMARY KEY ("USERID", "CATEGORYID")
);

CREATE TABLE "CLASSIFICATION" (
	"EVENTID" int NOT NULL REFERENCES "EVENT"("ID"),
	"CATEGORYID" int NOT NULL REFERENCES "CATEGORY"("ID"),
	PRIMARY KEY ("EVENTID", "CATEGORYID")
);
	
